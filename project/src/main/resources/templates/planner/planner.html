<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="main_layout"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">

<head>
    <title>Planner</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <link rel="stylesheet" href="/css/planner/planner.css"/>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/sockjs-client/1.6.1/sockjs.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/stomp.js/2.3.3/stomp.min.js"></script>
</head>


<body>
<div layout:fragment="content">

    <div class="container__contents">

        <div class="container__planner">

            <div style="display:none;" th:each="group : ${planner.travelGroup.participants}">
                <p th:text="${group.member.userId}">
            </div>

            <!-- 타이틀 -->
            <div class="wrapper__title">
                <div class="txt__title">
                    [[${planner.title}]]
                </div>
            </div>

            <!-- 독바 -->
            <div class="container__menu">

                <!-- 같이 여행가는 친구들 -->
                <div class="wrapper__friends">

                    <div class="profile">
                        <img style="width:60px; height: 60px" src="/img/btn_profile.png">
                    </div>

                    <div class="profile">
                        <img style="width:60px; height: 60px" src="/img/btn_profile.png">
                    </div>

                </div>

                <!-- 메뉴 -->
                <div class="wrapper__menu">
                    <!-- 나중에 주소 넣을때 사용 th:onclick="|location.href='@{/컨트롤러 주소}'|" -->
                    <button><img src="/img/btn_weather.png"></button>
                    <button><img src="/img/btn_live_chat.png"></button>
                    <button><img src="/img/btn_recommendation.png"></button>
                    <button><img src="/img/btn_planner.png"></button>
                    <button><img src="/img/btn_chatGPT.png"></button>
                    <button><img src="/img/btn_help.png"></button>
                </div>
            </div>

            <!-- 내용 -->
            <div class="container__plan">

                <!-- 계획 들어가는 박스 -->
                <div class="wrapper__plan">

                    <!-- 예산 박스 (고정) -->
                    <div class="wrapper__money">

                        <div class="money__title">
                            <div class="txt__money__title" style="margin-top: 10px">
                                예산 요약
                            </div>
                        </div>

                        <div class="wrapper__summary">

                            <!-- 총 예산 내역 (table)-->
                            <div class="summary">
                            </div>

                            <!-- 세부 내역 (table)-->
                            <div class="details">
                            </div>
                        </div>
                    </div>

                    <!-- 계획 박스 -->
                    <div class="container__kanban">

                        <div class="wrapper__planner__list">

                            <div th:each="todolist, status : ${planner.todolistResponses}" th:id="|f${todolist.tlIdx}|" class="wrapper__date__box">
                                <div class="date">
                                    <div th:text="${todolist.title}" th:id="|tl${todolist.tlIdx}|"></div>
                                    <input type="text" readonly th:value="${todolist.tlIdx}" th:id="|tlidx${todolist.tlIdx}|"/>
                                    <input type="text" th:value="${todolist.title}" th:id="|tltitle${todolist.tlIdx}|"/>
                                    <button th:attr="data-tlidx=|${todolist.tlIdx}|" class="todolistmod">todolist 제목 수정</button>
                                    <button th:attr="data-tlidx=|${todolist.tlIdx}|" class="todolistdel">todolist 삭제</button>

                                </div>

                                
                                    <div th:each="todo : ${todolist.todoResponses}" th:switch="${#strings.toString(todo.todoType)}" th:id="|d${todo.tdIdx}|" class="card">
                                        <div th:case="Accomodation">
                                            
                                                <p th:text="${todo.title}"/><p th:text="${todo.contents}"/><p th:text="${todo.todoDate}"/><p th:text="${todo.isPrivate}"/>
                                                <p th:text="${todo.acAddress}"/>
                                                <input type="text" readonly th:value="${todo.tdIdx}" th:id="|tdidx${todo.tdIdx}|"/>
                                                <input type="text" th:value="${todo.title}" th:id="|actodotitlemod${todo.tdIdx}|"/>
                                                <input type="text" th:value="${todo.contents}" th:id="|actodocontentmod${todo.tdIdx}|"/>
                                                <input type="text" th:value="${todo.todoDate}" th:id="|actododatemod${todo.tdIdx}|"/>
                                                <input type="text" th:value="${todo.acAddress}" th:id="|actodoaddressmod${todo.tdIdx}|"/>
                                                <input type="checkbox" th:value="${todo.isPrivate}" th:id="|actodopvmod${todo.tdIdx}|"/>
                                                <button th:attr="data-tdidx=|${todo.tdIdx}|" class="actodomod">수정</button>
                                                <button th:attr="data-tdidx=|${todo.tdIdx}|" class="actododel">삭제</button>
                                            
                                        </div>

                                        <div th:case="Attractions">
                                            <p th:text="${todo.title}"/><p th:text="${todo.contents}"/><p th:text="${todo.todoDate}"/><p th:text="${todo.isPrivate}"/>
                                            <p th:text="${todo.attractions}"/>
                                            <input type="text" readonly th:value="${todo.tdIdx}" th:id="|tdidx${todo.tdIdx}|"/>
                                            <input type="text" th:value="${todo.title}" th:id="|attodotitlemod${todo.tdIdx}|"/>
                                            <input type="text" th:value="${todo.contents}" th:id="|attodocontentmod${todo.tdIdx}|"/>
                                            <input type="text" th:value="${todo.todoDate}" th:id="|attododatemod${todo.tdIdx}|"/>
                                            <input type="text" th:value="${todo.attractions}" th:id="|attodoinfomod${todo.tdIdx}|"/>
                                            <input type="checkbox" th:value="${todo.isPrivate}" th:id="|attodopvmod${todo.tdIdx}|"/>
                                            <button th:attr="data-tdidx=|${todo.tdIdx}|" class="attodomod">Attractions todo 수정</button>
                                            <button th:attr="data-tdidx=|${todo.tdIdx}|" class="attododel">삭제</button>
                                        </div>

                                        <div th:case="Budget">
                                            <p th:text="${todo.title}"/><p th:text="${todo.contents}"/><p th:text="${todo.todoDate}"/><p th:text="${todo.isPrivate}"/>
                                            <p th:text="${todo.budgetType}"/><p th:text="${todo.budget}"/>
                                            <input type="text" readonly th:value="${todo.tdIdx}" th:id="|tdidx${todo.tdIdx}|"/>
                                            <input type="text" th:value="${todo.title}" th:id="|bgtodotitlemod${todo.tdIdx}|"/>
                                            <input type="text" th:value="${todo.contents}" th:id="|bgtodocontentmod${todo.tdIdx}|"/>
                                            <input type="text" th:value="${todo.todoDate}" th:id="|bgtododatemod${todo.tdIdx}|"/>
                                            <input type="text" th:value="${todo.budget}" th:id="|bgtodomoneymod${todo.tdIdx}|"/>
                                            <input type="text" th:value="${todo.budgetType}" th:id="|bgtodotypemod${todo.tdIdx}|"/>
                                            <input type="checkbox" th:value="${todo.isPrivate}" th:id="|bgtodopvmod${todo.tdIdx}|"/>
                                            <button th:attr="data-tdidx=|${todo.tdIdx}|" class="bgtodomod">수정</button>
                                            <button th:attr="data-tdidx=|${todo.tdIdx}|"class="bgtododel">삭제</button>
                                        </div>

                                        <div th:case="General">
                                            <p th:text="${todo.title}"/><p th:text="${todo.contents}"/><p th:text="${todo.todoDate}"/><p th:text="${todo.isPrivate}"/>
                                            <p th:text="${todo.gnAddress}"/>
                                            <input type="text" readonly th:value="${todo.tdIdx}" th:id="|tdidx${todo.tdIdx}|"/>
                                            <input type="text" th:value="${todo.title}" th:id="|gntodotitlemod${todo.tdIdx}|"/>
                                            <input type="text" th:value="${todo.contents}" th:id="|gntodocontentmod${todo.tdIdx}|"/>
                                            <input type="text" th:value="${todo.todoDate}" th:id="|gntododatemod${todo.tdIdx}|"/>
                                            <input type="text" th:value="${todo.gnAddress}" th:id="|gntodoaddressmod${todo.tdIdx}|"/>
                                            <input type="checkbox" th:value="${todo.isPrivate}" th:id="|gntodopvmod${todo.tdIdx}|"/>
                                            <button th:attr="data-tdidx=|${todo.tdIdx}|" class="gntodomod">General todo 수정</button>
                                            <button th:attr="data-tdidx=|${todo.tdIdx}|" class="gntododel">삭제</button>
                                        </div>

                                        <div th:case="Transport">
                                            <p th:text="${todo.title}"/><p th:text="${todo.contents}"/><p th:text="${todo.todoDate}"/><p th:text="${todo.isPrivate}"/>
                                            <p th:text="${todo.transportType}"/>
                                            <input type="text" readonly th:value="${todo.tdIdx}" th:id="|tdidx${todo.tdIdx}|"/>
                                            <input type="text" th:value="${todo.title}" th:id="|trtodotitlemod${todo.tdIdx}|"/>
                                            <input type="text" th:value="${todo.contents}" th:id="|trtodocontentmod${todo.tdIdx}|"/>
                                            <input type="text" th:value="${todo.todoDate}" th:id="|trtododatemod${todo.tdIdx}|"/>
                                            <input type="text" th:value="${todo.transportType}" th:id="|trtodotypemod${todo.tdIdx}|"/>
                                            <input type="checkbox" th:value="${todo.isPrivate}" th:id="|trtodopvmod${todo.tdIdx}|"/>
                                            <button th:attr="data-tdidx=|${todo.tdIdx}|" class="trtodomod">Transport todo 수정</button>
                                            <button th:attr="data-tdidx=|${todo.tdIdx}|" class="trtododel">삭제</button>
                                        </div>
                                        
                                        
                                    </div>
                                

                                <!-- 투두 카드 생기는 곳 -->
                                <div th:id="response"></div>

                                <!-- 버튼 클릭하면 카드 생성 (column) -->
                                <button class="open" th:onclick="addCard([[${todolist.tlIdx}]])" th:id="'addCardBtn' + ${todolist.tlIdx}"></button>

                                <!-- 등록 -->
                                <div style="display: none; background-color: white" class="add__card" th:id="'addCard' + ${todolist.tlIdx}">

                                    <!-- 독바 -->
                                    <div class="wrapper__bar" th:id="'addWhat' + ${todolist.tlIdx}">
                                        <button th:onclick="showAddTodo([[${todolist.tlIdx}]])">
                                            <img src="/img/btn_todo.png">
                                        </button>
                                        <button th:onclick="showAddTransport([[${todolist.tlIdx}]])">
                                            <img src="/img/btn_transport.png">
                                        </button>
                                        <button th:onclick="showAddAccommodation([[${todolist.tlIdx}]])">
                                            <img src="/img/btn_accommodation.png">
                                        </button>
                                        <button th:onclick="showAddMap([[${todolist.tlIdx}]])">
                                            <img src="/img/img_maps.png">
                                        </button>
                                        <button style="margin-right: 2px" th:onclick="showAddBudget([[${todolist.tlIdx}]])">
                                            <img src="/img/btn_calculator.png">
                                        </button>
                                    </div>

                                    <div th:id="'addAccommodation' + ${todolist.tlIdx}">
                                        <input type="text" th:value="숙박제목1" th:id="|actodotitleadd${todolist.tlIdx}|"/>
                                        <input type="text" th:value="숙박내용1" th:id="|actodocontentadd${todolist.tlIdx}|"/>
                                        <input type="text" th:value="|2023-06-12T19:25|" th:id="|actododateadd${todolist.tlIdx}|"/>
                                        <input type="text" th:value="숙박주소1" th:id="|actodoaddressadd${todolist.tlIdx}|"/>
                                        <input type="checkbox" th:id="|actodopvadd${todolist.tlIdx}|"/>
                                        <button th:attr="data-tlidx=|${todolist.tlIdx}|" class="actodoadd">Accomodation todo 등록</button>
                                    </div>

                                    <div th:id="'addAttraction' + ${todolist.tlIdx}">
                                        <input type="text" th:value="관광지내용1" th:id="|attodocontentadd${todolist.tlIdx}|"/>
                                        <input type="text" th:value="|2023-06-12T19:25|" th:id="|attododateadd${todolist.tlIdx}|"/>
                                        <input type="text" th:value="관광지제목1" th:id="|attodotitleadd${todolist.tlIdx}|"/>
                                        <input type="text" th:value="관광지정보1" th:id="|attodoinfoadd${todolist.tlIdx}|"/>
                                        <input type="checkbox" th:id="|attodopvadd${todolist.tlIdx}|"/>
                                        <button th:attr="data-tlidx=|${todolist.tlIdx}|" class="attodoadd">Attractions todo 등록</button>
                                    </div>

                                    <div th:id="'addBudget' + ${todolist.tlIdx}">
                                        <input type="text" th:value="예산제목1" th:id="|bgtodotitleadd${todolist.tlIdx}|"/>
                                        <input type="text" th:value="예산내용1" th:id="|bgtodocontentadd${todolist.tlIdx}|"/>
                                        <input type="text" th:value="|2023-06-12T19:25|" th:id="|bgtododateadd${todolist.tlIdx}|"/>
                                        <input type="text" th:value="10000" th:id="|bgtodomoneyadd${todolist.tlIdx}|"/>
                                        <input type="text" th:value="FOOD" th:id="|bgtodotypeadd${todolist.tlIdx}|"/>
                                        <input type="checkbox" th:id="|bgtodopvadd${todolist.tlIdx}|"/>
                                        <button th:attr="data-tlidx=|${todolist.tlIdx}|" class="bgtodoadd">Budget todo 등록</button>
                                    </div>

                                    <div th:id="'addGeneral' + ${todolist.tlIdx}">
                                        <input type="text" th:value="일반제목1" th:id="|gntodotitleadd${todolist.tlIdx}|"/>
                                        <input type="text" th:value="일반내용1" th:id="|gntodocontentadd${todolist.tlIdx}|"/>
                                        <input type="text" th:value="|2023-06-12T19:25|" th:id="|gntododateadd${todolist.tlIdx}|"/>
                                        <input type="text" th:value="일반주소1" th:id="|gntodoaddressadd${todolist.tlIdx}|"/>
                                        <input type="checkbox" th:id="|gntodopvadd${todolist.tlIdx}|"/>
                                        <button th:attr="data-tlidx=|${todolist.tlIdx}|" class="gntodoadd">General todo 등록</button>
                                    </div>

                                    <div th:id="'addTrans' + ${todolist.tlIdx}">
                                        <input type="text" th:value="교통제목1" th:id="|trtodotitleadd${todolist.tlIdx}|"/>
                                        <input type="text" th:value="교통내용1" th:id="|trtodocontentadd${todolist.tlIdx}|"/>
                                        <input type="text" th:value="|2023-06-12T19:25|" th:id="|trtododateadd${todolist.tlIdx}|"/>
                                        <input type="text" th:value="AIRPLANE" th:id="|trtodotypeadd${todolist.tlIdx}|"/>
                                        <input type="checkbox" th:id="|trtodopvadd${todolist.tlIdx}|"/>
                                        <button th:attr="data-tlidx=|${todolist.tlIdx}|" class="trtodoadd">General todo 등록</button>
                                    </div>
                                </div>

                                <!-- 하루 총 예산 -->
                                <div id="costPerDay"></div>

                            </div>

                            <div th:id="addDateResponse"></div>

                            <div id="addDate">
                                <input type="text" th:value="제목없음" name="todolistTitleAdd" id="todolistTitleAdd"/>
                                <button th:onclick="addTodoList()"><span>todolist 등록</span></button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
    <script src="/js/jQuery-2.1.4.min.js"></script>
    <script type="text/javascript" layout:fragment="script" th:inline="javascript">

        // 그룹 인원외 읽기만 ===============================================================================================//

        window.onload = function() {

            notGroupReadOnly();
        }

        function notGroupReadOnly() {

            const group = [[${planner.travelGroup.participants}]]
            const myId = [[${#authentication.name}]]

            console.log('myId', myId)
            console.log(group)

            // !! => true, false 변환 위해 사용
            const isTravelGroup = !!(group || []) // 1
                .find((obj) => {
                    const userId = (obj.member || {}).userId || '' // 2
                    if (!userId) return false // 3
                    return userId === myId // 4
                })

            console.log('isTravelGroup', isTravelGroup)

            // 여행그룹이 아닌 사람은 읽기전용
            if (!isTravelGroup) {

                // 읽기 전용
                //$('input').prop('readonly', true);

                // 안보이게
                $('input').hide();
                $('.todolistmod').hide();
                $('.todolistdel').hide();
                $('.actodomod').hide();
                $('.actododel').hide();
                $('.attodomod').hide();
                $('.attododel').hide();
                $('.bgtodomod').hide();
                $('.bgtododel').hide();
                $('.gntodomod').hide();
                $('.gntododel').hide();
                $('.trtodomod').hide();
                $('.trtododel').hide();
                $('.open').hide();
                $('.add__card').hide();
                $('#addDate').hide();
            }
        }

        // 카드 추가창 ===============================================================================================//

        function addCard(str) {

            console.log(str);
            document.getElementById('addCard' + str).style.display = '';
            document.getElementById('addAccommodation' + str).style.display = 'none';
            //document.getElementById('addAttraction' + str).style.display = 'none';
            //document.getElementById('addBudget' + str).style.display = 'none';
            //document.getElementById('addGeneral' + str).style.display = 'none';
            //document.getElementById('addTrans' + str).style.display = 'none';
            document.getElementById('addCardBtn' + str).style.display = 'none';

        }

        function showAddTodo(str) {

            document.getElementById('addAccommodation' + str).style.display = 'none';
            document.getElementById('addAttraction' + str).style.display = 'none';
            document.getElementById('addBudget' + str).style.display = 'none';
            document.getElementById('addGeneral' + str).style.display = '';
            document.getElementById('addTrans' + str).style.display = 'none';
            document.getElementById('addCardBtn' + str).style.display = 'none';
        }

        function showAddTransport(str) {

            document.getElementById('addAccommodation' + str).style.display = 'none';
            document.getElementById('addAttraction' + str).style.display = 'none';
            document.getElementById('addBudget' + str).style.display = 'none';
            document.getElementById('addGeneral' + str).style.display = 'none';
            document.getElementById('addTrans' + str).style.display = '';
            document.getElementById('addCardBtn' + str).style.display = 'none';
        }

        function showAddAccommodation(str) {

            document.getElementById('addAccommodation' + str).style.display = '';
            //document.getElementById('addAttraction' + str).style.display = 'none';
            //document.getElementById('addBudget' + str).style.display = 'none';
            //document.getElementById('addGeneral' + str).style.display = 'none';
            //document.getElementById('addTrans' + str).style.display = 'none';
            document.getElementById('addCardBtn' + str).style.display = 'none';
        }

        function showAddMap(str) {

            document.getElementById('addAccommodation' + str).style.display = 'none';
            document.getElementById('addAttraction' + str).style.display = '';
            document.getElementById('addBudget' + str).style.display = 'none';
            document.getElementById('addGeneral' + str).style.display = 'none';
            document.getElementById('addTrans' + str).style.display = 'none';
            document.getElementById('addCardBtn' + str).style.display = 'none';
        }

        function showAddBudget(str) {

            document.getElementById('addAccommodation' + str).style.display = 'none';
            document.getElementById('addAttraction' + str).style.display = 'none';
            document.getElementById('addBudget' + str).style.display = '';
            document.getElementById('addGeneral' + str).style.display = 'none';
            document.getElementById('addTrans' + str).style.display = 'none';
            document.getElementById('addCardBtn' + str).style.display = 'none';
        }

        // 새로고침 ===================================================//

        function reload() {

            location.reload();
        }

        /* [start] 웹소켓 ============================================================================================== */

        var stompClient = null;
        
        var mIdx = 1;
        //모듈화
        function connect() {
            var socket = new SockJS('/gs-guide-websocket');

            stompClient= Stomp.over(socket);
            stompClient.connect({}, function (frame) {
                console.log('Connected: ' + frame);
                stompClient.subscribe('/topic/planner-message/' + [[${planner.tpIdx}]], function (recommand) {
                        res = JSON.parse(recommand.body);
                        console.log('res: '+res);
                        // 그룹추가
                        if(res.type === 'add-group'){
                            response.innerHTML += '<span style="background:yellow">'+ res.msg.userId + '<br>'+'</span>';

                        }else if(res.type === 'upload-todolist'){
                        	
                        	
                        	let todolist = document.createElement("div");
                        	todolist.id='f'+res.msg.tlIdx;
                        	todolist.className = "wrapper__date__box";
                        	addDateResponse.after(todolist);
                        	
                        	let date = document.createElement("div");
                        	date.id ="date"+res.msg.tlIdx;
                        	date.className = "date";
                        	document.querySelector('#f'+res.msg.tlIdx).appendChild(date);
                        	
                        	let tl = document.createElement("div");
                        	tl.innerText= res.msg.title;
                        	tl.id = "tl"+res.msg.tlIdx;
                        	document.querySelector('#date'+res.msg.tlIdx).appendChild(tl);
                        	
                        	let tltitle = document.createElement("input");
                        	tltitle.id = "tltitle"+res.msg.tlIdx;
                        	tltitle.value = res.msg.title;
                        	document.querySelector('#date'+res.msg.tlIdx).appendChild(tltitle);
                        	
                        	let todolistmod = document.createElement("button");
                        	todolistmod.id = "todolistmod"+res.msg.tlIdx;
                        	todolistmod.className = "todolistmod";
                        	todolistmod.dataset.tlidx = res.msg.tlIdx;
                        	todolistmod.innerHTML= "todolist 제목 수정";
                        	document.querySelector('#date'+res.msg.tlIdx).appendChild(todolistmod);
                        	todolistmod.addEventListener('click', ev => {
                        		let tlIdx = ev.target.dataset.tlidx;
                                console.log('tlIdx: '+tlIdx);

                                let todolistIdx = tlIdx;
                                let todolistTitle = document.getElementById('tltitle'+tlIdx).value;

                                console.log('todolistIdx: '+todolistIdx);
                                console.log('todolistTitle: '+todolistTitle);
								
                                stompClient.send("/app/modify-todolist/" + [[${planner.tpIdx}]], {}, JSON.stringify({'title':todolistTitle, 'tlIdx':todolistIdx}));
                                //tl.innerText = todolistTitle;//음..
                        	});
                        	
                        	let todolistdel = document.createElement("button");
                        	todolistdel.id = "todolistdel"+res.msg.tlIdx;
                        	todolistdel.className = "todolistdel";
                        	todolistdel.dataset.tlidx = res.msg.tlIdx;
                        	todolistdel.innerHTML= "todolist 삭제";
                        	document.querySelector('#date'+res.msg.tlIdx).appendChild(todolistdel);
                        	todolistdel.addEventListener('click', ev => {
                        		let tlIdx = ev.target.dataset.tlidx;
                                console.log('tlIdx: '+tlIdx);

                                let todolistIdx = tlIdx;

                                console.log('todolistIdx: '+todolistIdx);

                                stompClient.send("/app/remove-todolist/" + [[${planner.tpIdx}]], {}, JSON.stringify({'tlIdx':todolistIdx}));

                        	});
                        	/////////////////
                        	
                        	//let todo = document.createElement("div");
                        	//todo.id='d'+res.msg.tlIdx;
                        	//todo.className = "card";
                        	//document.querySelector('#f'+res.msg.tlIdx).appendChild(todo);
                        	
                        	//let actodo = document.createElement("div");
                        	//actodo.id='ac'+res.msg.tlIdx;
                        	//actodo.className = "actodo";
                        	//document.querySelector('#d'+res.msg.tlIdx).appendChild(actodo);
                        	
                        	
                        	//let attodo = document.createElement("div");
                        	//attodo.id='at'+res.msg.tlIdx;
                        	//attodo.className = "actodo";
                        	//document.querySelector('#d'+res.msg.tlIdx).appendChild(attodo);
                        	
                        	
                        	//let bgtodo = document.createElement("div");
                        	//bgtodo.id='bg'+res.msg.tlIdx;
                        	//bgtodo.className = "bgtodo";
                        	//document.querySelector('#d'+res.msg.tlIdx).appendChild(bgtodo);
                        	
                        	
                        	//let gntodo = document.createElement("div");
                        	//gntodo.id='gn'+res.msg.tlIdx;
                        	//gntodo.className = "gntodo";
                        	//document.querySelector('#d'+res.msg.tlIdx).appendChild(gntodo);
                        	

                        	//let trtodo = document.createElement("div");
                        	//trtodo.id='tr'+res.msg.tlIdx;
                        	//trtodo.className = "trtodo";
                        	//document.querySelector('#d'+res.msg.tlIdx).appendChild(trtodo);
                        	
                        	/////////////////
                        	let tdresponse = document.createElement("div");
                        	tdresponse.id="mresponse";
                        	document.querySelector('#f'+res.msg.tlIdx).appendChild(tdresponse);
                        	
                        	let addcardbtn = document.createElement("button");
                        	addcardbtn.id="addCardBtn"+ res.msg.tlIdx;
                        	addcardbtn.className = "open";
                        	addcardbtn.onclick=function(){addCard(res.msg.tlIdx);};
                        	document.querySelector('#f'+res.msg.tlIdx).appendChild(addcardbtn);
                        	
                        	let addcard = document.createElement("div");
                        	addcard.id="addCard"+res.msg.tlIdx;
                        	addcard.className = "add__card";
                        	addcard.style.display = 'none';
                        	addcard.style.backgroundColor = "white";
                        	document.querySelector('#f'+res.msg.tlIdx).appendChild(addcard);
                        	
                        	let addwhat = document.createElement("div"); 
                        	addwhat.id="addWhat"+res.msg.tlIdx;
                        	addwhat.className = "wrapper__bar";
                        	document.querySelector('#addCard'+res.msg.tlIdx).appendChild(addwhat);
                        	
                        	<!-- 독바 -->
                        	let showAddAc = document.createElement("button");
                        	showAddAc.id="showAddAccommodation"+ res.msg.tlIdx;
                        	showAddAc.onclick=function(){showAddAccommodation(res.msg.tlIdx);};
                        	showAddAc.innerHTML= '<img src="/img/btn_accommodation.png">';
                        	document.querySelector('#addWhat'+res.msg.tlIdx).appendChild(showAddAc);
                        	
                        	
                        	let addAc = document.createElement("div"); 
                        	addAc.id="addAccommodation"+res.msg.tlIdx;
                        	document.querySelector('#addCard'+res.msg.tlIdx).appendChild(addAc);
                        	
                        	let addAcTitle = document.createElement("input"); 
                        	addAcTitle.id="actodotitleadd"+res.msg.tlIdx;
                        	addAcTitle.nodeType = "text";
                        	addAcTitle.value = "숙박제목";
                        	document.querySelector('#addAccommodation'+res.msg.tlIdx).appendChild(addAcTitle);
                        	
                        	let addAcContent = document.createElement("input"); 
                        	addAcContent.id="actodocontentadd"+res.msg.tlIdx;
                        	addAcContent.nodeType = "text";
                        	addAcContent.value = "숙박내용";
                        	document.querySelector('#addAccommodation'+res.msg.tlIdx).appendChild(addAcContent);
                        	
                        	let addAcDate = document.createElement("input"); 
                        	addAcDate.id="actododateadd"+res.msg.tlIdx;
                        	addAcDate.setAttribute("type", "datetime-local");
                        	document.querySelector('#addAccommodation'+res.msg.tlIdx).appendChild(addAcDate);
                        	
                        	let addAcAddress = document.createElement("input"); 
                        	addAcAddress.id="actodoaddressadd"+res.msg.tlIdx;
                        	addAcAddress.nodeType = "text";
                        	addAcAddress.value = "숙박주소";
                        	document.querySelector('#addAccommodation'+res.msg.tlIdx).appendChild(addAcAddress);
                        	
                        	let addAcPv = document.createElement("input"); 
                        	addAcPv.id="actodopvadd"+res.msg.tlIdx;
                        	addAcPv.setAttribute("type", "checkbox");
                        	document.querySelector('#addAccommodation'+res.msg.tlIdx).appendChild(addAcPv);
                        	
                        	let addAcButton = document.createElement("button"); 
                        	addAcButton.id="actodoadd"+res.msg.tlIdx;
                        	addAcButton.className = "actodoadd";
                        	addAcButton.dataset.tlidx = res.msg.tlIdx;
                        	addAcButton.innerHTML= "Accomodation todo 등록";
                        	document.querySelector('#addAccommodation'+res.msg.tlIdx).appendChild(addAcButton);
                        	addAcButton.addEventListener('click', ev => {
                        		let tlIdx = ev.target.dataset.tlidx;
                                console.log('tlIdx: '+tlIdx);

                                let todolistIdx = tlIdx;
                                let actodotitle = document.getElementById('actodotitleadd'+tlIdx).value;
                                let actodocontent = document.getElementById('actodocontentadd'+tlIdx).value;
                                let actododate = document.getElementById('actododateadd'+tlIdx).value;
                                let actodoaddress = document.getElementById('actodoaddressadd'+tlIdx).value;
                                let actodoprivate = document.getElementById('actodopvadd'+tlIdx).checked;

                                console.log('todolistIdx: '+todolistIdx);
                                console.log('actodotitle: '+actodotitle);
                                console.log('actodocontent: '+actodocontent);
                                console.log('actododate: '+actododate);
                                console.log('actodoaddress: '+actodoaddress);
                                console.log('actodoprivate: '+actodoprivate);

                                stompClient.send("/app/upload-accomodation/" + [[${planner.tpIdx}]]+"/"+tlIdx, {},
                                    JSON.stringify({'title':actodotitle, 'contents':actodocontent, 'todoDate':actododate,
                                        'address':actodoaddress, 'isPrivate':actodoprivate}));
                        	});
                        	
                        	
                        }else if(res.type === 'modify-todolist'){

                            // 날짜 수정
                            console.log('res.msg.tlIdx: '+res.msg.tlIdx);
                            console.log('res.msg.title: '+res.msg.title);
                            // document.querySelector('#f'+res.msg.tlIdx).style.display='none';
                            //response.innerHTML += '<span style="background:yellow">'+ res.msg.title +'</span>';
                            document.getElementById('tl'+res.msg.tlIdx).innerHTML = res.msg.title;

                        }else if(res.type === 'remove-todolist'){

                            // 날짜 삭제
                            console.log('res.msg: '+res.msg);
                            document.querySelector('#f'+res.msg).style.display='none';

                        }else if(res.type === 'upload-accomodation'){

                           
                            console.log('res.msg.tdIdx: ' + res.msg.tdIdx);
                            // 숙박 추가
                            console.log('res.msg.title: '+res.msg.title);
                            console.log('res.msg.contents: '+res.msg.contents);
                            console.log('res.msg.todoDate: '+res.msg.todoDate);
                            console.log('res.msg.address: '+res.msg.address);
                            console.log('res.msg.isPrivate: '+res.msg.isPrivate);
                            //console.log('res.msg.todoType: '+res.msg.todoType);

                            
                            let todo = document.createElement("div");
                            todo.id='d'+res.msg.tdIdx;
                            todo.className = "card";
                            mresponse.append(todo);
                               
                            let title = document.createElement("p"); 
                            title.innerHTML = res.msg.title;
                            document.querySelector('#d'+res.msg.tdIdx).appendChild(title);
                            
                            let contents = document.createElement("p"); 
                            contents.innerHTML = res.msg.contents;
                            document.querySelector('#d'+res.msg.tdIdx).appendChild(contents);
                            
                            let todoDate = document.createElement("p"); 
                            todoDate.innerHTML = res.msg.todoDate;
                            document.querySelector('#d'+res.msg.tdIdx).appendChild(todoDate);
                            
                            let address = document.createElement("p"); 
                            address.innerHTML = res.msg.address;
                            document.querySelector('#d'+res.msg.tdIdx).appendChild(address);
                            
                            let isPrivate = document.createElement("p"); 
                            isPrivate.innerHTML = res.msg.isPrivate;
                            document.querySelector('#d'+res.msg.tdIdx).appendChild(isPrivate);
                            
                            let td = document.createElement("input");
                            td.nodeType = "text";
                            td.value = res.msg.tdIdx;
                        	document.querySelector('#d'+res.msg.tdIdx).appendChild(td);
                            
                            let titlemod = document.createElement("input");
                            titlemod.nodeType = "text";
                            titlemod.value = res.msg.title;
                            document.querySelector('#d'+res.msg.tdIdx).appendChild(titlemod);
                            
                            let contentsmod = document.createElement("input");
                            contentsmod.nodeType = "text";
                            contentsmod.value = res.msg.contents;
                            document.querySelector('#d'+res.msg.tdIdx).appendChild(contentsmod);
                            
                            let todoDatemod = document.createElement("input");
                            todoDatemod.setAttribute("type", "datetime-local");
                            //todoDatemod.value = res.msg.todoDate;
                            document.querySelector('#d'+res.msg.tdIdx).appendChild(todoDatemod);
                            
                            let isPrivatemod = document.createElement("input");
                            isPrivatemod.setAttribute("type", "checkbox");
                            if(res.msg.isPrivate){
                            	isPrivatemod.checked =true;
                            }else{
                            	isPrivatemod.checked =false;
                            }
                        	document.querySelector('#d'+res.msg.tdIdx).appendChild(isPrivatemod);
                            
                        	let acmodbutton = document.createElement("button");
                        	acmodbutton.id = "acmodbutton"+res.msg.tdIdx;
                        	acmodbutton.className = "actodomod";
                        	acmodbutton.dataset.tdidx = res.msg.tdIdx;
                        	acmodbutton.innerHTML= "수정";
                        	document.querySelector('#d'+res.msg.tdIdx).appendChild(acmodbutton);
                        	acmodbutton.addEventListener('click', ev => {
                        		let tdIdx = ev.target.dataset.tdidx;
                                console.log('tdIdx: '+tdIdx);

                                let actodoIdx = tdIdx;
                                let actodotitle = document.getElementById('actodotitlemod'+tdIdx).value;
                                let actodocontent = document.getElementById('actodocontentmod'+tdIdx).value;
                                let actododate = document.getElementById('actododatemod'+tdIdx).value;
                                let actodoaddress = document.getElementById('actodoaddressmod'+tdIdx).value;
                                let actodoprivate = document.getElementById('actodopvmod'+tdIdx).checked;

                                console.log('actodoIdx: '+actodoIdx);
                                console.log('actodotitle: '+actodotitle);
                                console.log('actodocontent: '+actodocontent);
                                console.log('actododate: '+actododate);
                                console.log('actodoaddress: '+actodoaddress);
                                console.log('actodoprivate: '+actodoprivate);

                                stompClient.send("/app/modify-accomodation/" + [[${planner.tpIdx}]], {},
                                    JSON.stringify({'tdIdx':actodoIdx, 'title':actodotitle, 'contents':actodocontent, 'todoDate':actododate,
                                        'address':actodoaddress, 'isPrivate':actodoprivate}));

                            });
                        	
                        	let acdelbutton = document.createElement("button");
                        	acdelbutton.id = "acdelbutton"+res.msg.tdIdx;
                        	acdelbutton.className = "actododel";
                        	acdelbutton.dataset.tdidx = res.msg.tdIdx;
                        	acdelbutton.innerHTML= "삭제";
                        	document.querySelector('#d'+res.msg.tdIdx).appendChild(acdelbutton);
                        	acdelbutton.addEventListener('click', ev => {
                                let tdIdx = ev.target.dataset.tdidx;
                                console.log('tdIdx: '+tdIdx);

                                let actodoIdx = document.getElementById('tdidx'+tdIdx).value;

                                console.log('actodoIdx: '+actodoIdx);

                                stompClient.send("/app/remove-accomodation/" + [[${planner.tpIdx}]], {},
                                    JSON.stringify({'tdIdx':actodoIdx }));

                            });
                        	

                        }else if(res.type === 'modify-accomodation'){

                            // 숙박 수정
                            console.log('res.msg.title: '+res.msg.title);
                            console.log('res.msg.contents: '+res.msg.contents);
                            console.log('res.msg.todoDate: '+res.msg.todoDate);
                            console.log('res.msg.address: '+res.msg.address);
                            console.log('res.msg.isPrivate: '+res.msg.isPrivate);

                            let id = 'd'+res.msg.tdIdx;
                            document.getElementById(id).innerHTML =
                                '<span style="background:yellow">'+ "숙박todo 제목, 내용, 날짜, 주소, 비밀: " + res.msg.title + " ,  " +res.msg.contents +
                                res.msg.todoDate + " ,  " +res.msg.address + " ,  " +res.msg.isPrivate+ '<br>'+'</span>'
                            

                        }else if(res.type === 'remove-accomodation'){

                            //숙박 삭제
                            console.log('res.msg: '+res.msg);
                            document.querySelector('#d'+res.msg).style.display='none';


                        }else if(res.type === 'upload-attractions'){

                            // 관광지 추가
                            console.log('res.msg.title: '+res.msg.title);
                            console.log('res.msg.contents: '+res.msg.contents);
                            console.log('res.msg.todoDate: '+res.msg.todoDate);
                            console.log('res.msg.attractions: '+res.msg.attractions);
                            console.log('res.msg.isPrivate: '+res.msg.isPrivate);

                            var attrResponse = document.getElementById('response');

                            console.log('어디냐: ' + res.msg.tdIdx);
                            console.log('어디냐: ' + res.msg.tdIdx);

                            attrResponse.innerHTML +=
                                '<div class="card">' + res.msg.title + '</div>'

                        }else if(res.type === 'modify-attractions'){

                            // 관광지 수정
                            console.log('res.msg.title: '+res.msg.title);
                            console.log('res.msg.contents: '+res.msg.contents);
                            console.log('res.msg.todoDate: '+res.msg.todoDate);
                            console.log('res.msg.attractions: '+res.msg.attractions);
                            console.log('res.msg.isPrivate: '+res.msg.isPrivate);
                            //document.querySelector('#d'+res.msg.tdIdx).style.display='none';
                            //response.innerHTML +=
                            let id = 'd'+res.msg.tdIdx;
                            document.getElementById(id).innerHTML =
                                '<span style="background:yellow">'+ "관광지todo 제목, 내용, 날짜, 주소, 비밀: " + res.msg.title + " ,  " +res.msg.contents +
                                res.msg.todoDate + " ,  " +res.msg.attractions + " ,  " +res.msg.isPrivate+ '<br>'+'</span>';

                        }else if(res.type === 'remove-attractions'){

                            // 관광지 삭제
                            console.log('res.msg: '+res.msg);
                            document.querySelector('#d'+res.msg).style.display='none';

                        }else if(res.type === 'upload-budget'){

                            // 예산 추가
                            console.log('res.msg.title:', res.msg.title);
                            console.log('res.msg.contents: '+res.msg.contents);
                            console.log('res.msg.todoDate: '+res.msg.todoDate);
                            console.log('res.msg.budget: '+res.msg.budget);
                            console.log('res.msg.budgetType: '+res.msg.budgetType);
                            console.log('res.msg.isPrivate: '+res.msg.isPrivate);

                            var budgetResponse = document.getElementById('response');

                            console.log('어디냐: ' + res.msg.tdIdx);
                            console.log('어디냐: ' + res.msg.tdIdx);

                            budgetResponse.innerHTML +=
                                '<div class="card">' + res.msg.title + '</div>'

                        }else if(res.type === 'modify-budget'){

                            // 예산 수정
                            console.log('res.msg.title: '+res.msg.title);
                            console.log('res.msg.contents: '+res.msg.contents);
                            console.log('res.msg.todoDate: '+res.msg.todoDate);
                            console.log('res.msg.address: '+res.msg.address);
                            console.log('res.msg.isPrivate: '+res.msg.isPrivate);
                            //document.querySelector('#d'+res.msg.tdIdx).style.display='none';
                            //response.innerHTML +=
                            let id = 'd'+res.msg.tdIdx;
                            document.getElementById(id).innerHTML =
                                '<span style="background:yellow">'+ "예산todo 제목, 내용, 날짜, 주소, 비밀: " + res.msg.title + " ,  " +res.msg.contents +
                                res.msg.todoDate + " ,  " +res.msg.address + " ,  " +res.msg.isPrivate+ '<br>'+'</span>';

                        }else if(res.type === 'remove-budget'){

                            // 예산 삭제
                            console.log('res.msg: '+res.msg);
                            document.querySelector('#d'+res.msg).style.display='none';

                        }else if(res.type === 'upload-general'){

                            // 일반 투두 추가
                            console.log('res.msg.title: '+res.msg.title);
                            console.log('res.msg.contents: '+res.msg.contents);
                            console.log('res.msg.todoDate: '+res.msg.todoDate);
                            console.log('res.msg.address: '+res.msg.address);
                            console.log('res.msg.isPrivate: '+res.msg.isPrivate);

                            var generalResponse = document.getElementById('response');

                            console.log('어디냐: ' + res.msg.tdIdx);
                            console.log('어디냐: ' + res.msg.tdIdx);

                            generalResponse.innerHTML +=
                                '<div class="card">' + res.msg.title + '</div>'

                        }else if(res.type === 'modify-general'){

                            // 일반 투두 수정
                            console.log('res.msg.title: '+res.msg.title);
                            console.log('res.msg.contents: '+res.msg.contents);
                            console.log('res.msg.todoDate: '+res.msg.todoDate);
                            console.log('res.msg.address: '+res.msg.address);
                            console.log('res.msg.isPrivate: '+res.msg.isPrivate);
                            //document.querySelector('#d'+res.msg.tdIdx).style.display='none';
                            //response.innerHTML +=
                            let id = 'd'+res.msg.tdIdx;
                            document.getElementById(id).innerHTML =
                                '<span style="background:yellow">'+ "일반todo 제목, 내용, 날짜, 주소, 비밀: " + res.msg.title + " ,  " +res.msg.contents +
                                res.msg.todoDate + " ,  " +res.msg.address + " ,  " +res.msg.isPrivate+ '<br>'+'</span>';

                        }else if(res.type === 'remove-general'){

                            // 일반 투두 제거
                            console.log('res.msg: '+res.msg);
                            document.querySelector('#d'+res.msg).style.display='none';


                        }else if(res.type === 'upload-transport'){

                            // 교통 추가
                            console.log('res.msg.title: '+res.msg.title);
                            console.log('res.msg.contents: '+res.msg.contents);
                            console.log('res.msg.todoDate: '+res.msg.todoDate);
                            console.log('res.msg.transportType: '+res.msg.transportType);
                            console.log('res.msg.isPrivate: '+res.msg.isPrivate);

                            var transResponse = document.getElementById('response');

                            console.log('어디냐: ' + res.msg.tdIdx);
                            console.log('어디냐: ' + res.msg.tdIdx);

                            transResponse.innerHTML +=
                                '<div class="card">' + res.msg.title + '</div>'

                        }else if(res.type === 'modify-transport'){

                            // 교통 수정
                            console.log('res.msg.title: '+res.msg.title);
                            console.log('res.msg.contents: '+res.msg.contents);
                            console.log('res.msg.todoDate: '+res.msg.todoDate);
                            console.log('res.msg.transportType: '+res.msg.transportType);
                            console.log('res.msg.isPrivate: '+res.msg.isPrivate);
                            //document.querySelector('#d'+res.msg.tdIdx).style.display='none';
                            //response.innerHTML +=
                            let id = 'd'+res.msg.tdIdx;
                            document.getElementById(id).innerHTML =
                                '<span style="background:yellow">'+ "교통todo 제목, 내용, 날짜, 종류, 비밀: " + res.msg.title + " ,  " +res.msg.contents +
                                res.msg.todoDate + " ,  " +res.msg.transportType + " ,  " +res.msg.isPrivate+ '<br>'+'</span>';

                        }else if(res.type === 'remove-transport'){

                            // 교통 삭제
                            console.log('res.msg: '+res.msg);
                            document.querySelector('#d'+res.msg).style.display='none';
                        }

                    }
                );
            });

        }

        function modTodoListDisconnect() {
            if (stompClient !== null) {
                stompClient.disconnect();
            }
            console.log("Disconnected");

        }

        //공유 인원 추가
        function addGroup() {

            let newUserId = newUser.value;
            stompClient.send("/app/add-group/" + [[${planner.tpIdx}]], {}, JSON.stringify({'newUserId':newUserId}));

        }

        //투두리스트 추가
        function addTodoList() {
            let title = todolistTitleAdd.value;
            console.dir(title);
            stompClient.send("/app/upload-todolist/" + [[${planner.tpIdx}]], {}, JSON.stringify({'title':title}));

        }

        //투두리스트 수정

        document.querySelectorAll('.todolistmod').forEach(e => {
            e.addEventListener('click', ev => {

                let tlIdx = ev.target.dataset.tlidx;
                console.log('tlIdx: '+tlIdx);

                let todolistIdx = document.getElementById('tlidx'+tlIdx).value;
                let todolistTitle = document.getElementById('tltitle'+tlIdx).value;

                console.log('todolistIdx: '+todolistIdx);
                console.log('todolistTitle: '+todolistTitle);

                stompClient.send("/app/modify-todolist/" + [[${planner.tpIdx}]], {}, JSON.stringify({'title':todolistTitle, 'tlIdx':todolistIdx}));

            });

        })

        //투두리스트 삭제

        document.querySelectorAll('.todolistdel').forEach(e => {
            e.addEventListener('click', ev => {

                let tlIdx = ev.target.dataset.tlidx;
                console.log('tlIdx: '+tlIdx);

                let todolistIdx = document.getElementById('tlidx'+tlIdx).value;

                console.log('todolistIdx: '+todolistIdx);

                stompClient.send("/app/remove-todolist/" + [[${planner.tpIdx}]], {}, JSON.stringify({'tlIdx':todolistIdx}));

            });

        })

        //숙박투두카드 추가

        document.querySelectorAll('.actodoadd').forEach(e => {
            e.addEventListener('click', ev => {

                let tlIdx = ev.target.dataset.tlidx;
                console.log('tlIdx: '+tlIdx);

                let todolistIdx = document.getElementById('tlidx'+tlIdx).value;
                let actodotitle = document.getElementById('actodotitleadd'+tlIdx).value;
                let actodocontent = document.getElementById('actodocontentadd'+tlIdx).value;
                let actododate = document.getElementById('actododateadd'+tlIdx).value;
                let actodoaddress = document.getElementById('actodoaddressadd'+tlIdx).value;
                let actodoprivate = document.getElementById('actodopvadd'+tlIdx).checked;

                console.log('todolistIdx: '+todolistIdx);
                console.log('actodotitle: '+actodotitle);
                console.log('actodocontent: '+actodocontent);
                console.log('actododate: '+actododate);
                console.log('actodoaddress: '+actodoaddress);
                console.log('actodoprivate: '+actodoprivate);

                stompClient.send("/app/upload-accomodation/" + [[${planner.tpIdx}]]+"/"+tlIdx, {},
                    JSON.stringify({'title':actodotitle, 'contents':actodocontent, 'todoDate':actododate,
                        'address':actodoaddress, 'isPrivate':actodoprivate}));

            });

        })

        //숙박투두카드 수정

        document.querySelectorAll('.actodomod').forEach(e => {
            e.addEventListener('click', ev => {

                //let tlIdx = ev.target.dataset.tlidx;
                //console.log('tlIdx: '+tlIdx);
                let tdIdx = ev.target.dataset.tdidx;
                console.log('tdIdx: '+tdIdx);

                let actodoIdx = document.getElementById('tdidx'+tdIdx).value;
                let actodotitle = document.getElementById('actodotitlemod'+tdIdx).value;
                let actodocontent = document.getElementById('actodocontentmod'+tdIdx).value;
                let actododate = document.getElementById('actododatemod'+tdIdx).value;
                let actodoaddress = document.getElementById('actodoaddressmod'+tdIdx).value;
                let actodoprivate = document.getElementById('actodopvmod'+tdIdx).checked;

                console.log('actodoIdx: '+actodoIdx);
                console.log('actodotitle: '+actodotitle);
                console.log('actodocontent: '+actodocontent);
                console.log('actododate: '+actododate);
                console.log('actodoaddress: '+actodoaddress);
                console.log('actodoprivate: '+actodoprivate);

                stompClient.send("/app/modify-accomodation/" + [[${planner.tpIdx}]], {},
                    JSON.stringify({'tdIdx':actodoIdx, 'title':actodotitle, 'contents':actodocontent, 'todoDate':actododate,
                        'address':actodoaddress, 'isPrivate':actodoprivate}));

            });

        })

        //숙박투두카드 삭제

        document.querySelectorAll('.actododel').forEach(e => {
            e.addEventListener('click', ev => {

                let tdIdx = ev.target.dataset.tdidx;
                console.log('tdIdx: '+tdIdx);

                let actodoIdx = document.getElementById('tdidx'+tdIdx).value;

                console.log('actodoIdx: '+actodoIdx);

                stompClient.send("/app/remove-accomodation/" + [[${planner.tpIdx}]], {},
                    JSON.stringify({'tdIdx':actodoIdx }));

            });

        })

        //관광지투두카드 추가

        document.querySelectorAll('.attodoadd').forEach(e => {
            e.addEventListener('click', ev => {

                let tlIdx = ev.target.dataset.tlidx;
                console.log('tlIdx: '+tlIdx);

                let todolistIdx = document.getElementById('tlidx'+tlIdx).value;
                let attodotitle = document.getElementById('attodotitleadd'+tlIdx).value;
                let attodocontent = document.getElementById('attodocontentadd'+tlIdx).value;
                let attododate = document.getElementById('attododateadd'+tlIdx).value;
                let attodoinfo = document.getElementById('attodoinfoadd'+tlIdx).value;
                let attodoprivate = document.getElementById('attodopvadd'+tlIdx).checked;

                console.log('todolistIdx: '+todolistIdx);
                console.log('attodotitle: '+attodotitle);
                console.log('attodocontent: '+attodocontent);
                console.log('attododate: '+attododate);
                console.log('attodoinfo: '+attodoinfo);
                console.log('attodoprivate: '+attodoprivate);

                stompClient.send("/app/upload-attractions/" + [[${planner.tpIdx}]]+"/"+tlIdx, {},
                    JSON.stringify({'title':attodotitle, 'contents':attodocontent, 'todoDate':attododate,
                        'attractions':attodoinfo, 'isPrivate':attodoprivate}));

            });

        })

        //관광지투두카드 수정

        document.querySelectorAll('.attodomod').forEach(e => {
            e.addEventListener('click', ev => {

                let tdIdx = ev.target.dataset.tdidx;
                console.log('tdIdx: '+tdIdx);

                let attodoIdx = document.getElementById('tdidx'+tdIdx).value;
                let attodotitle = document.getElementById('attodotitlemod'+tdIdx).value;
                let attodocontent = document.getElementById('attodocontentmod'+tdIdx).value;
                let attododate = document.getElementById('attododatemod'+tdIdx).value;
                let attodoinfo = document.getElementById('attodoinfomod'+tdIdx).value;
                let attodoprivate = document.getElementById('attodopvmod'+tdIdx).checked;

                console.log('attodoIdx: '+attodoIdx);
                console.log('attodotitle: '+attodotitle);
                console.log('attodocontent: '+attodocontent);
                console.log('attododate: '+attododate);
                console.log('attodoinfo: '+attodoinfo);
                console.log('attodoprivate: '+attodoprivate);

                stompClient.send("/app/modify-attractions/" + [[${planner.tpIdx}]], {},
                    JSON.stringify({'tdIdx':attodoIdx, 'title':attodotitle, 'contents':attodocontent, 'todoDate':attododate,
                        'attractions':attodoinfo, 'isPrivate':attodoprivate}));

            });

        })

        //관광지투두카드 삭제

        document.querySelectorAll('.attododel').forEach(e => {
            e.addEventListener('click', ev => {

                let tdIdx = ev.target.dataset.tdidx;
                console.log('tdIdx: '+tdIdx);

                let attodoIdx = document.getElementById('tdidx'+tdIdx).value;

                console.log('attodoIdx: '+attodoIdx);

                stompClient.send("/app/remove-attractions/" + [[${planner.tpIdx}]], {},
                    JSON.stringify({'tdIdx':attodoIdx }));

            });

        })

        //예산투두카드 추가

        document.querySelectorAll('.bgtodoadd').forEach(e => {
            e.addEventListener('click', ev => {

                let tlIdx = ev.target.dataset.tlidx;
                console.log('tlIdx: '+tlIdx);

                let todolistIdx = document.getElementById('tlidx'+tlIdx).value;
                let bgtodotitle = document.getElementById('bgtodotitleadd'+tlIdx).value;
                let bgtodocontent = document.getElementById('bgtodocontentadd'+tlIdx).value;
                let bgtododate = document.getElementById('bgtododateadd'+tlIdx).value;
                let bgtodomoney = document.getElementById('bgtodomoneyadd'+tlIdx).value;
                let bgtodotype = document.getElementById('bgtodotypeadd'+tlIdx).value;
                let bgtodoprivate = document.getElementById('bgtodopvadd'+tlIdx).checked;

                console.log('todolistIdx: '+todolistIdx);
                console.log('bgtodotitle: '+bgtodotitle);
                console.log('bgtodocontent: '+bgtodocontent);
                console.log('bgtododate: '+bgtododate);
                console.log('bgtodomoney: '+bgtodomoney);
                console.log('bgtodotype: '+bgtodotype);
                console.log('bgtodoprivate: '+bgtodoprivate);

                stompClient.send("/app/upload-budget/" + [[${planner.tpIdx}]]+"/"+tlIdx, {},
                    JSON.stringify({'title':bgtodotitle, 'contents':bgtodocontent, 'todoDate':bgtododate,
                        'budget':bgtodomoney, 'budgetType':bgtodotype, 'isPrivate':bgtodoprivate}));

            });

        })

        //예산투두카드 수정

        document.querySelectorAll('.bgtodomod').forEach(e => {
            e.addEventListener('click', ev => {

                let tdIdx = ev.target.dataset.tdidx;
                console.log('tdIdx: '+tdIdx);

                let bgtodoIdx = document.getElementById('tdidx'+tdIdx).value;
                let bgtodotitle = document.getElementById('bgtodotitlemod'+tdIdx).value;
                let bgtodocontent = document.getElementById('bgtodocontentmod'+tdIdx).value;
                let bgtododate = document.getElementById('bgtododatemod'+tdIdx).value;
                let bgtodomoney = document.getElementById('bgtodomoneymod'+tdIdx).value;
                let bgtodotype = document.getElementById('bgtodotypemod'+tdIdx).value;
                let bgtodoprivate = document.getElementById('bgtodopvmod'+tdIdx).checked;

                console.log('bgtodoIdx: '+bgtodoIdx);
                console.log('bgtodotitle: '+bgtodotitle);
                console.log('bgtodocontent: '+bgtodocontent);
                console.log('bgtododate: '+bgtododate);
                console.log('bgtodomoney: '+bgtodomoney);
                console.log('bgtodotype: '+bgtodotype);
                console.log('bgtodoprivate: '+bgtodoprivate);

                stompClient.send("/app/modify-budget/" + [[${planner.tpIdx}]], {},
                    JSON.stringify({'tdIdx':bgtodoIdx, 'title':bgtodotitle, 'contents':bgtodocontent, 'todoDate':bgtododate,
                        'budget':bgtodomoney, 'budgetType':bgtodotype, 'isPrivate':bgtodoprivate}));

            });

        })

        //예산투두카드 삭제

        document.querySelectorAll('.bgtododel').forEach(e => {
            e.addEventListener('click', ev => {

                let tdIdx = ev.target.dataset.tdidx;
                console.log('tdIdx: '+tdIdx);

                let bgtodoIdx = document.getElementById('tdidx'+tdIdx).value;

                console.log('bgtodoIdx: '+bgtodoIdx);

                stompClient.send("/app/remove-budget/" + [[${planner.tpIdx}]], {},
                    JSON.stringify({'tdIdx':bgtodoIdx }));

            });


        })

        //일반투두카드 추가

        document.querySelectorAll('.gntodoadd').forEach(e => {
            e.addEventListener('click', ev => {

                let tlIdx = ev.target.dataset.tlidx;
                console.log('tlIdx: '+tlIdx);

                let todolistIdx = document.getElementById('tlidx'+tlIdx).value;
                let gntodotitle = document.getElementById('gntodotitleadd'+tlIdx).value;
                let gntodocontent = document.getElementById('gntodocontentadd'+tlIdx).value;
                let gntododate = document.getElementById('gntododateadd'+tlIdx).value;
                let gntodoaddress = document.getElementById('gntodoaddressadd'+tlIdx).value;
                let gntodoprivate = document.getElementById('gntodopvadd'+tlIdx).checked;

                console.log('todolistIdx: '+todolistIdx);
                console.log('gntodotitle: '+gntodotitle);
                console.log('gntodocontent: '+gntodocontent);
                console.log('gntododate: '+gntododate);
                console.log('gntodoaddress: '+gntodoaddress);
                console.log('gntodoprivate: '+gntodoprivate);

                stompClient.send("/app/upload-general/" + [[${planner.tpIdx}]]+"/"+tlIdx, {},
                    JSON.stringify({'title':gntodotitle, 'contents':gntodocontent, 'todoDate':gntododate,
                        'address':gntodoaddress, 'isPrivate':gntodoprivate}));

            });

        })

        //일반투두카드 수정

        document.querySelectorAll('.gntodomod').forEach(e => {
            e.addEventListener('click', ev => {

                let tdIdx = ev.target.dataset.tdidx;
                console.log('tdIdx: '+tdIdx);

                let gntodoIdx = document.getElementById('tdidx'+tdIdx).value;
                let gntodotitle = document.getElementById('gntodotitlemod'+tdIdx).value;
                let gntodocontent = document.getElementById('gntodocontentmod'+tdIdx).value;
                let gntododate = document.getElementById('gntododatemod'+tdIdx).value;
                let gntodoaddress = document.getElementById('gntodoaddressmod'+tdIdx).value;
                let gntodoprivate = document.getElementById('gntodopvmod'+tdIdx).checked;

                console.log('gntodoIdx: '+gntodoIdx);
                console.log('gntodotitle: '+gntodotitle);
                console.log('gntodocontent: '+gntodocontent);
                console.log('gntododate: '+gntododate);
                console.log('gntodoaddress: '+gntodoaddress);
                console.log('gntodoprivate: '+gntodoprivate);

                stompClient.send("/app/modify-general/" + [[${planner.tpIdx}]], {},
                    JSON.stringify({'tdIdx':gntodoIdx, 'title':gntodotitle, 'contents':gntodocontent, 'todoDate':gntododate,
                        'address':gntodoaddress, 'isPrivate':gntodoprivate}));

            });

        })

        //일반투두카드 삭제

        document.querySelectorAll('.gntododel').forEach(e => {
            e.addEventListener('click', ev => {

                let tdIdx = ev.target.dataset.tdidx;
                console.log('tdIdx: '+tdIdx);

                let gntodoIdx = document.getElementById('tdidx'+tdIdx).value;

                console.log('gntodoIdx: '+gntodoIdx);

                stompClient.send("/app/remove-general/" + [[${planner.tpIdx}]], {},
                    JSON.stringify({'tdIdx':gntodoIdx }));

            });

        })

        //교통투두카드 추가

        document.querySelectorAll('.trtodoadd').forEach(e => {
            e.addEventListener('click', ev => {

                let tlIdx = ev.target.dataset.tlidx;
                console.log('tlIdx: '+tlIdx);

                let todolistIdx = document.getElementById('tlidx'+tlIdx).value;
                let trtodotitle = document.getElementById('trtodotitleadd'+tlIdx).value;
                let trtodocontent = document.getElementById('trtodocontentadd'+tlIdx).value;
                let trtododate = document.getElementById('trtododateadd'+tlIdx).value;
                let trtodotype = document.getElementById('trtodotypeadd'+tlIdx).value;
                let trtodoprivate = document.getElementById('trtodopvadd'+tlIdx).checked;

                console.log('todolistIdx: '+todolistIdx);
                console.log('trtodotitle: '+trtodotitle);
                console.log('trtodocontent: '+trtodocontent);
                console.log('trtododate: '+trtododate);
                console.log('trtodotype: '+trtodotype);
                console.log('trtodoprivate: '+trtodoprivate);

                stompClient.send("/app/upload-transport/" + [[${planner.tpIdx}]]+"/"+tlIdx, {},
                    JSON.stringify({'title':trtodotitle, 'contents':trtodocontent, 'todoDate':trtododate,
                        'transportType':trtodotype, 'isPrivate':trtodoprivate}));

            });

        })

        //교통투두카드 수정

        document.querySelectorAll('.trtodomod').forEach(e => {
            e.addEventListener('click', ev => {

                let tdIdx = ev.target.dataset.tdidx;
                console.log('tdIdx: '+tdIdx);

                let trtodoIdx = document.getElementById('tdidx'+tdIdx).value;
                let trtodotitle = document.getElementById('trtodotitlemod'+tdIdx).value;
                let trtodocontent = document.getElementById('trtodocontentmod'+tdIdx).value;
                let trtododate = document.getElementById('trtododatemod'+tdIdx).value;
                let trtodotype = document.getElementById('trtodotypemod'+tdIdx).value;
                let trtodoprivate = document.getElementById('trtodopvmod'+tdIdx).checked;

                console.log('trtodoIdx: '+trtodoIdx);
                console.log('trtodotitle: '+trtodotitle);
                console.log('trtodocontent: '+trtodocontent);
                console.log('trtododate: '+trtododate);
                console.log('trtodotype: '+trtodotype);
                console.log('trtodoprivate: '+trtodoprivate);

                stompClient.send("/app/modify-transport/" + [[${planner.tpIdx}]], {},
                    JSON.stringify({'tdIdx':trtodoIdx, 'title':trtodotitle, 'contents':trtodocontent, 'todoDate':trtododate,
                        'transportType':trtodotype, 'isPrivate':trtodoprivate}));

            });

        })

        //교통투두카드 삭제
        document.querySelectorAll('.trtododel').forEach(e => {

            e.addEventListener('click', ev => {

                let tdIdx = ev.target.dataset.tdidx;
                console.log('tdIdx: '+tdIdx);

                let trtodoIdx = document.getElementById('tdidx'+tdIdx).value;

                console.log('trtodoIdx: '+trtodoIdx);

                stompClient.send("/app/remove-transport/" + [[${planner.tpIdx}]], {},
                    JSON.stringify({'tdIdx':trtodoIdx }));

            });
        })

        /* [end] 웹소켓 ============================================================================================== */

        connect();
    </script>
    <!--<span>공유 인원 목록</span>
        <ol>

            <li th:each="group : ${planner.travelGroup.participants}">
              <p th:text="${group.member.userId}">

             </li>

             &lt;!&ndash;  <form th:action="@{/planner/add-group}" method="post" >
              <input type="text" th:value="group1B" name="newUserId"/>
                <input type="hidden" th:value="${planner.tpIdx}" name="tpIdx"/>
                <button><span>공유 인원 추가</span></button>
            </form>
            &ndash;&gt;
        </ol>
                <div id="addGroupResponse"></div>
                <input type="text" th:value="group1B" name="newUserId" id ="newUser"/>
                <button onclick="addGroup()"><span>공유 인원 추가</span></button>
    </div>

    <div class="article_content">
        <pre>[[${planner.title}]]</pre>
    </div>
    <div class="btn_section">

        <button onclick="location.href='/planner/list'"><span>목록으로 돌아가기</span></button>


    </div>
    <br>
    <br>-->

</div>
</body>
</html>